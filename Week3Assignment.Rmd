---
title: "Plotly Assignment"
author: "Jeff Ball"
date: "December 23, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Plotly Interactive Graph

In honor of the new movie *Rogue One* this simple interactive graph allows someone to zoom in on what appears to be a lava planet.  For this demonstration, I'll call it "Mustaf" and the function is contained in a file called "Mustaf.R"

The 3D plot creates 500 random points in 7 different layers.  The user can rotate as well as zoom in and zoom out.  For purposes of this assignment the code is echoed to the screen; the interactive graph is below.

```{r Initialize, echo=FALSE}
	suppressWarnings(suppressMessages(library(plotly)))
```

```{r createPoints,echo=TRUE}
	layers <- 7		# number of layers
	np <- 500		# number of points for each sphere

	for (i in 1:layers)
	{
		r <- i * 5	# radius will grow in increments of 5
	
#	create random points for each layer...

		angleInc <- runif(np,min=0,max=pi)		# inclination
		angleAzm <- runif(np,min=0,max=2*pi)	# azimuth
		xa <- r * sin(angleInc) * cos(angleAzm)	
		ya <- r * sin(angleInc) * sin(angleAzm)
		za <- r * cos(angleInc)
		ca <- rep(i,times=np)

#	bring the vectors together...

		if (i==1)
		{
			x <- xa
			y <- ya
			z <- za
			c <- ca
		}
		else
		{
			x <- c(x,xa)
			y <- c(y,ya)
			z <- c(z,za)
			c <- c(c,ca)
		}
	}

	df <- data.frame(x,y,z,c)
```

```{r plot3D,echo=TRUE}
	plot_ly(df,x=~x,y=~y,z=~z,type="scatter3d",
		mode="markers",
		color=~c,
#		colors="GnBu") %>%	    # use this for Dagobah
#		colors="Blues") %>%	    # use this for Kamino
		colors="YlOrRd") %>%	# use this for Mustafar
#		colors="Greys") %>%	    # use this for Hoth
	layout(plot_bgcolor="black") %>%
	layout(paper_bgcolor="black")
```